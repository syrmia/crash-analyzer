# Produced with clang++ -g -O0 m.cpp -o m

#void f()
#{
#    char a = 0x0F;
#    short b = 0x00FF;
#    int c = 0x00FFFFFF;
#    long d = 0x00FFFFFFFFFFFFFF;
#    int *p = nullptr;
#
#    long d1 = 0x0011111111111111;
#    long d2 = 0x0022222222222222;
#
#    long db = 0x0;
#
#    // a = a + 1;
#    // a = a - 2;
#    
#    // b = b + 1;
#    // b = b - 2;
#    // b = b + 0x1000;
#    // b = b - 0x1001;
#
#    __asm__(
#        "mov %0, %%al;"
#        "add $1, %%al;"
#        "sub $2, %%al;"
#        "mov %%al, %0;"
#        
#        "mov %1, %%ax;"
#        "add $1, %%ax;"
#        "sub $2, %%ax;"
#        "add $4096, %%ax;"
#        "sub $4097, %%ax;"
#        "mov %%ax, %1;"
#        :"=m" (a), "=m" (b)
#        :"0" (a), "1" (b)
#    );
#
#
#    c = c + 1;
#    c = c - 2;
#    c = c + 0x1000;
#    c = c - 0x1001;
#
#    d = d + 1;
#    d = d - 2;
#    d = d + 0x1000;
#    d = d - 0x1001;
#
#    d = d + d1 - d2;
#
#    __asm__(
#        "movq %0, %%rax;"
#       "movq $20, %%rbx;"
#        "addq %%rbx, %%rax;"
#        "movq %%rbx, %1;"
#        "movq %%rax, %0;"
#        :"=m" (d), "=m" (db)
#        :"0" (d), "1" (db)
#    );
#
#    *p = 1;
#}
#int main()
#{
#    f();
#    return 0;
#}

# RUN: %llvm-crash-analyzer --core-file=%S/Inputs/core.arithmetic-insts \
# RUN: %S/Inputs/arithmetic-insts --print-potential-crash-cause-loc \
# RUN: --debug-only=mem-wrapper 2>&1 | FileCheck %s

# CHECK: Addressing valid location: 0x00007ffc9cb3c630 : 0x00eeeeeeeeeeef00, byte_size: 8
# CHECK: Writing location: 0x00007ffc9cb3c630 : 0x00eeeeeeeeeeeeec, byte_size: 8
# CHECK: Writing location: 0x00007ffc9cb3c630 : 0x00fffffffffffffd, byte_size: 8
# CHECK: Addressing valid location: 0x00007ffc9cb3c630 : 0x00fffffffffffffd, byte_size: 8
# CHECK: Writing location: 0x00007ffc9cb3c630 : 0x0100000000000ffe, byte_size: 8
# CHECK: Writing location: 0x00007ffc9cb3c630 : 0x00ffffffffffffff, byte_size: 8
# CHECK: Addressing valid location: 0x00007ffc9cb3c638 : 0x00fffffd, byte_size: 4
# CHECK: Writing location: 0x00007ffc9cb3c638 : 0x01000ffe, byte_size: 4
# CHECK: Writing location: 0x00007ffc9cb3c638 : 0x00ffffff, byte_size: 4
# CHECK: Addressing valid location:  0x00007ffc9cb3c63c : 0x00fd, byte_size: 2
# CHECK: Writing location:  0x00007ffc9cb3c63c : 0x00ff, byte_size: 2
# CHECK: Addressing valid location: 0x00007ffc9cb3c63f : 0x0e, byte_size: 1
# CHECK: Writing location: 0x00007ffc9cb3c63f : 0x0f, byte_size: 1

# CHECK: Blame Function is f()
# CHECK-NEXT: From File {{.*}}:7:10